<svg width="1600" height="1200" xmlns="http://www.w3.org/2000/svg">
  <!-- 标题 -->
  <text x="800" y="60" text-anchor="middle" font-size="28" font-weight="bold" fill="#333">MySQL InnoDB存储结构示意图</text>
  <text x="800" y="95" text-anchor="middle" font-size="16" fill="#666">主键索引、二级索引与数据存储结构</text>
  
  <!-- ========== 主键索引区域 ========== -->
  <rect x="80" y="120" width="500" height="420" rx="8" ry="8" fill="#f8faff" stroke="#4a6bff" stroke-width="2"/>
  <rect x="100" y="140" width="460" height="40" rx="4" ry="4" fill="#e6ecff"/>
  <text x="280" y="165" text-anchor="middle" font-size="18" font-weight="bold" fill="#2d4cd2">主键索引（聚集索引）</text>
  <text x="280" y="185" text-anchor="middle" font-size="14" fill="#4a6bff">Clustered Index (Primary Key)</text>
  
  <!-- 主键索引B+树结构 -->
  <text x="280" y="220" text-anchor="middle" font-size="16" font-weight="bold" fill="#333">B+树结构</text>
  
  <!-- 根节点 -->
  <rect x="220" y="240" width="120" height="50" rx="6" ry="6" fill="#ffffff" stroke="#4a6bff" stroke-width="2"/>
  <text x="280" y="265" text-anchor="middle" font-size="12" font-weight="bold">根节点</text>
  <text x="280" y="280" text-anchor="middle" font-size="10">PK: 15, 30</text>
  
  <!-- 分支节点 -->
  <rect x="140" y="310" width="100" height="45" rx="4" ry="4" fill="#ffffff" stroke="#4a6bff" stroke-width="1.5"/>
  <rect x="260" y="310" width="100" height="45" rx="4" ry="4" fill="#ffffff" stroke="#4a6bff" stroke-width="1.5"/>
  <rect x="380" y="310" width="100" height="45" rx="4" ry="4" fill="#ffffff" stroke="#4a6bff" stroke-width="1.5"/>
  
  <text x="190" y="335" text-anchor="middle" font-size="11">PK < 15</text>
  <text x="310" y="335" text-anchor="middle" font-size="11">15 ≤ PK < 30</text>
  <text x="430" y="335" text-anchor="middle" font-size="11">PK ≥ 30</text>
  
  <!-- 连接线 -->
  <path d="M280,290 L190,310" stroke="#4a6bff" stroke-width="1.5" fill="none"/>
  <path d="M280,290 L310,310" stroke="#4a6bff" stroke-width="1.5" fill="none"/>
  <path d="M280,290 L430,310" stroke="#4a6bff" stroke-width="1.5" fill="none"/>
  
  <!-- 叶子节点 -->
  <rect x="80" y="380" width="160" height="130" rx="6" ry="6" fill="#eef2ff" stroke="#4a6bff" stroke-width="2"/>
  <rect x="260" y="380" width="160" height="130" rx="6" ry="6" fill="#eef2ff" stroke="#4a6bff" stroke-width="2"/>
  <rect x="440" y="380" width="160" height="130" rx="6" ry="6" fill="#eef2ff" stroke="#4a6bff" stroke-width="2"/>
  
  <text x="160" y="405" text-anchor="middle" font-size="12" font-weight="bold">叶子节点1</text>
  <text x="340" y="405" text-anchor="middle" font-size="12" font-weight="bold">叶子节点2</text>
  <text x="520" y="405" text-anchor="middle" font-size="12" font-weight="bold">叶子节点3</text>
  
  <!-- 叶子节点之间的双向链表指针 -->
  <path d="M240,445 L260,445" stroke="#ff6b35" stroke-width="2" fill="none"/>
  <polygon points="260,445 255,440 255,450" fill="#ff6b35"/>
  <path d="M420,445 L440,445" stroke="#ff6b35" stroke-width="2" fill="none"/>
  <polygon points="440,445 435,440 435,450" fill="#ff6b35"/>
  <text x="340" y="440" text-anchor="middle" font-size="11" fill="#ff6b35" font-weight="bold">双向链表指针</text>
  
  <!-- 叶子节点中的行数据 -->
  <g transform="translate(90, 420)">
    <!-- 行1 -->
    <rect width="140" height="25" rx="3" ry="3" fill="#ffffff" stroke="#4a6bff" stroke-width="1"/>
    <text x="5" y="13" font-size="10" dominant-baseline="middle">PK: 10 | Name: Alice</text>
    <text x="5" y="22" font-size="8" dominant-baseline="middle" fill="#666">Age: 25 | Dept: Sales</text>
    
    <!-- 行2 -->
    <rect y="30" width="140" height="25" rx="3" ry="3" fill="#ffffff" stroke="#4a6bff" stroke-width="1"/>
    <text x="5" y="43" font-size="10" dominant-baseline="middle">PK: 12 | Name: Bob</text>
    <text x="5" y="52" font-size="8" dominant-baseline="middle" fill="#666">Age: 30 | Dept: IT</text>
    
    <!-- 行3 -->
    <rect y="60" width="140" height="25" rx="3" ry="3" fill="#ffffff" stroke="#4a6bff" stroke-width="1"/>
    <text x="5" y="73" font-size="10" dominant-baseline="middle">PK: 14 | Name: Carol</text>
    <text x="5" y="82" font-size="8" dominant-baseline="middle" fill="#666">Age: 28 | Dept: HR</text>
  </g>
  
  <g transform="translate(270, 420)">
    <!-- 行4 -->
    <rect width="140" height="25" rx="3" ry="3" fill="#ffffff" stroke="#4a6bff" stroke-width="1"/>
    <text x="5" y="13" font-size="10" dominant-baseline="middle">PK: 15 | Name: David</text>
    <text x="5" y="22" font-size="8" dominant-baseline="middle" fill="#666">Age: 35 | Dept: Finance</text>
    
    <!-- 行5 -->
    <rect y="30" width="140" height="25" rx="3" ry="3" fill="#ffffff" stroke="#4a6bff" stroke-width="1"/>
    <text x="5" y="43" font-size="10" dominant-baseline="middle">PK: 18 | Name: Eve</text>
    <text x="5" y="52" font-size="8" dominant-baseline="middle" fill="#666">Age: 22 | Dept: Marketing</text>
  </g>
  
  <g transform="translate(450, 420)">
    <!-- 行6 -->
    <rect width="140" height="25" rx="3" ry="3" fill="#ffffff" stroke="#4a6bff" stroke-width="1"/>
    <text x="5" y="13" font-size="10" dominant-baseline="middle">PK: 30 | Name: Frank</text>
    <text x="5" y="22" font-size="8" dominant-baseline="middle" fill="#666">Age: 40 | Dept: Management</text>
    
    <!-- 行7 -->
    <rect y="30" width="140" height="25" rx="3" ry="3" fill="#ffffff" stroke="#4a6bff" stroke-width="1"/>
    <text x="5" y="43" font-size="10" dominant-baseline="middle">PK: 35 | Name: Grace</text>
    <text x="5" y="52" font-size="8" dominant-baseline="middle" fill="#666">Age: 32 | Dept: R&amp;D</text>
  </g>
  
  <!-- 主键索引特点 -->
  <rect x="100" y="520" width="460" height="120" rx="6" ry="6" fill="#f0f7ff" stroke="#4a6bff" stroke-width="1"/>
  <text x="120" y="540" font-size="14" font-weight="bold" fill="#2d4cd2">主键索引特点：</text>
  <g font-size="12" fill="#333">
    <text x="120" y="565">• 叶子节点存储完整行数据（聚集索引）</text>
    <text x="120" y="585">• 数据按主键顺序物理存储</text>
    <text x="120" y="605">• 叶子节点间通过双向链表连接</text>
    <text x="120" y="625">• 支持高效的范围查询和排序</text>
  </g>
  
  <!-- ========== 二级索引区域 ========== -->
  <rect x="650" y="120" width="500" height="300" rx="8" ry="8" fill="#fff8f5" stroke="#ff8a3d" stroke-width="2"/>
  <rect x="670" y="140" width="460" height="40" rx="4" ry="4" fill="#ffefe6"/>
  <text x="830" y="165" text-anchor="middle" font-size="18" font-weight="bold" fill="#cc5a1a">二级索引（非聚集索引）</text>
  <text x="830" y="185" text-anchor="middle" font-size="14" fill="#ff8a3d">Secondary Index (idx_dept)</text>
  
  <!-- 二级索引B+树结构 -->
  <text x="830" y="220" text-anchor="middle" font-size="16" font-weight="bold" fill="#333">B+树结构（以Dept列为索引）</text>
  
  <!-- 根节点 -->
  <rect x="770" y="240" width="120" height="50" rx="6" ry="6" fill="#ffffff" stroke="#ff8a3d" stroke-width="2"/>
  <text x="830" y="265" text-anchor="middle" font-size="12" font-weight="bold">根节点</text>
  <text x="830" y="280" text-anchor="middle" font-size="10">Dept: IT, Sales</text>
  
  <!-- 叶子节点 -->
  <rect x="670" y="310" width="460" height="90" rx="6" ry="6" fill="#fff5f0" stroke="#ff8a3d" stroke-width="2"/>
  <text x="800" y="330" text-anchor="middle" font-size="12" font-weight="bold">叶子节点（存储Dept + 主键值）</text>
  
  <!-- 叶子节点中的索引条目 -->
  <g transform="translate(680, 350)">
    <!-- 索引条目 -->
    <rect width="440" height="20" rx="3" ry="3" fill="#ffffff" stroke="#ff8a3d" stroke-width="1"/>
    <text x="10" y="12" font-size="10" dominant-baseline="middle">
      <tspan fill="#cc5a1a">Dept: Finance</tspan>
      <tspan x="100" fill="#4a6bff">→ PK: 15</tspan>
      <tspan x="170" fill="#cc5a1a">Dept: HR</tspan>
      <tspan x="240" fill="#4a6bff">→ PK: 14</tspan>
      <tspan x="300" fill="#cc5a1a">Dept: IT</tspan>
      <tspan x="370" fill="#4a6bff">→ PK: 12</tspan>
    </text>
    
    <rect y="25" width="440" height="20" rx="3" ry="3" fill="#ffffff" stroke="#ff8a3d" stroke-width="1"/>
    <text x="10" y="37" font-size="10" dominant-baseline="middle">
      <tspan fill="#cc5a1a">Dept: Management</tspan>
      <tspan x="120" fill="#4a6bff">→ PK: 30</tspan>
      <tspan x="190" fill="#cc5a1a">Dept: Marketing</tspan>
      <tspan x="280" fill="#4a6bff">→ PK: 18</tspan>
      <tspan x="350" fill="#cc5a1a">Dept: R&amp;D</tspan>
      <tspan x="410" fill="#4a6bff">→ PK: 35</tspan>
    </text>
    
    <rect y="50" width="440" height="20" rx="3" ry="3" fill="#ffffff" stroke="#ff8a3d" stroke-width="1"/>
    <text x="10" y="62" font-size="10" dominant-baseline="middle">
      <tspan fill="#cc5a1a">Dept: Sales</tspan>
      <tspan x="80" fill="#4a6bff">→ PK: 10</tspan>
    </text>
  </g>
  
  <!-- 二级索引特点 -->
  <rect x="670" y="430" width="460" height="120" rx="6" ry="6" fill="#fff5f0" stroke="#ff8a3d" stroke-width="1"/>
  <text x="690" y="450" font-size="14" font-weight="bold" fill="#cc5a1a">二级索引特点：</text>
  <g font-size="12" fill="#333">
    <text x="690" y="475">• 叶子节点存储索引列值 + 主键值</text>
    <text x="690" y="495">• 按索引列值排序（非物理顺序）</text>
    <text x="690" y="515">• 通过主键值引用主键索引（回表查询）</text>
    <text x="690" y="535">• 覆盖索引：查询列都在索引中时，无需回表</text>
  </g>
  
  <!-- ========== 数据页结构区域 ========== -->
  <rect x="1200" y="120" width="320" height="520" rx="8" ry="8" fill="#f5fff8" stroke="#34c759" stroke-width="2"/>
  <rect x="1220" y="140" width="280" height="40" rx="4" ry="4" fill="#e6ffe6"/>
  <text x="1360" y="165" text-anchor="middle" font-size="18" font-weight="bold" fill="#1e7a34">数据页结构</text>
  <text x="1360" y="185" text-anchor="middle" font-size="14" fill="#34c759">InnoDB Page (16KB)</text>
  
  <!-- 数据页内部结构 -->
  <rect x="1240" y="210" width="240" height="400" fill="#f8fff8" stroke="#34c759" stroke-width="2"/>
  
  <!-- 页头 -->
  <rect x="1240" y="210" width="240" height="45" fill="#ccffcc"/>
  <text x="1360" y="230" text-anchor="middle" font-size="12" font-weight="bold">Page Header</text>
  <text x="1360" y="245" text-anchor="middle" font-size="10">56 bytes - 页面控制信息</text>
  
  <!-- 最小/最大记录 -->
  <rect x="1240" y="255" width="240" height="30" fill="#e0ffe0"/>
  <text x="1360" y="272" text-anchor="middle" font-size="11">Infimum/Supremum Records</text>
  
  <!-- 行记录 -->
  <rect x="1240" y="285" width="240" height="220" fill="#ffffff"/>
  <text x="1360" y="300" text-anchor="middle" font-size="13" font-weight="bold">行记录 (Rows)</text>
  
  <!-- 示例行记录 -->
  <rect x="1260" y="320" width="200" height="60" fill="#f8f8f8" stroke="#34c759" stroke-width="1"/>
  <line x1="1260" y1="340" x2="1460" y2="340" stroke="#34c759" stroke-width="1"/>
  <line x1="1260" y1="360" x2="1460" y2="360" stroke="#34c759" stroke-width="1"/>
  <text x="1270" y="335" font-size="10">Row Header (5 bytes)</text>
  <text x="1270" y="355" font-size="10">Transaction ID (6 bytes)</text>
  <text x="1270" y="375" font-size="10">Roll Pointer (7 bytes)</text>
  
  <rect x="1260" y="385" width="200" height="50" fill="#f0f8f0" stroke="#34c759" stroke-width="1"/>
  <text x="1270" y="400" font-size="10">Primary Key Column(s)</text>
  <text x="1270" y="415" font-size="10">Column 1 Value</text>
  <text x="1270" y="430" font-size="10">Column 2 Value ...</text>
  
  <rect x="1260" y="440" width="200" height="40" fill="#f8f8f8" stroke="#34c759" stroke-width="1"/>
  <text x="1270" y="455" font-size="10">More rows...</text>
  
  <!-- 空闲空间 -->
  <rect x="1240" y="505" width="240" height="45" fill="#ffffcc"/>
  <text x="1360" y="525" text-anchor="middle" font-size="12" font-weight="bold">Free Space</text>
  <text x="1360" y="540" text-anchor="middle" font-size="10">可用于插入新记录</text>
  
  <!-- 页目录 -->
  <rect x="1240" y="550" width="240" height="45" fill="#ffebcc"/>
  <text x="1360" y="570" text-anchor="middle" font-size="12" font-weight="bold">Page Directory</text>
  <text x="1360" y="585" text-anchor="middle" font-size="10">槽位数组，加速记录查找</text>
  
  <!-- 页尾 -->
  <rect x="1240" y="595" width="240" height="30" fill="#ffcccc"/>
  <text x="1360" y="612" text-anchor="middle" font-size="12" font-weight="bold">Page Trailer</text>
  <text x="1360" y="625" text-anchor="middle" font-size="10">8 bytes - 校验信息</text>
  
  <!-- ========== 查询流程区域 ========== -->
  <rect x="80" y="680" width="1440" height="200" rx="8" ry="8" fill="#f9f9ff" stroke="#666" stroke-width="1"/>
  <text x="800" y="710" text-anchor="middle" font-size="20" font-weight="bold" fill="#333">查询流程示例</text>
  
  <!-- 主键查询流程 -->
  <rect x="120" y="740" width="320" height="120" rx="6" ry="6" fill="#f0f7ff" stroke="#4a6bff" stroke-width="1"/>
  <text x="280" y="760" text-anchor="middle" font-size="16" font-weight="bold" fill="#2d4cd2">主键查询</text>
  <text x="280" y="780" text-anchor="middle" font-size="12" fill="#4a6bff">SELECT * FROM users WHERE id = 15</text>
  
  <g font-size="12" fill="#333">
    <text x="140" y="805">1. 从主键索引根节点开始查找</text>
    <text x="140" y="825">2. 根据B+树结构定位到叶子节点</text>
    <text x="140" y="845">3. 在叶子节点中找到完整行数据</text>
    <text x="140" y="865">✓ 无需回表，一次索引查找即可</text>
  </g>
  
  <!-- 二级索引查询流程 -->
  <rect x="480" y="740" width="320" height="120" rx="6" ry="6" fill="#fff5f0" stroke="#ff8a3d" stroke-width="1"/>
  <text x="640" y="760" text-anchor="middle" font-size="16" font-weight="bold" fill="#cc5a1a">二级索引查询（需要回表）</text>
  <text x="640" y="780" text-anchor="middle" font-size="12" fill="#ff8a3d">SELECT * FROM users WHERE dept = 'IT'</text>
  
  <g font-size="12" fill="#333">
    <text x="500" y="805">1. 从二级索引根节点开始查找</text>
    <text x="500" y="825">2. 定位到叶子节点，找到主键值(12)</text>
    <text x="500" y="845">3. 用主键值(12)回主键索引查找行数据</text>
    <text x="500" y="865">✗ 需要两次索引查找（回表）</text>
  </g>
  
  <!-- 覆盖索引查询流程 -->
  <rect x="840" y="740" width="320" height="120" rx="6" ry="6" fill="#f5fff8" stroke="#34c759" stroke-width="1"/>
  <text x="1000" y="760" text-anchor="middle" font-size="16" font-weight="bold" fill="#1e7a34">覆盖索引查询</text>
  <text x="1000" y="780" text-anchor="middle" font-size="12" fill="#34c759">SELECT id, dept FROM users WHERE dept = 'IT'</text>
  
  <g font-size="12" fill="#333">
    <text x="860" y="805">1. 从二级索引根节点开始查找</text>
    <text x="860" y="825">2. 定位到叶子节点，找到主键值(12)和dept</text>
    <text x="860" y="845">3. 所需列已在索引中，无需回表</text>
    <text x="860" y="865">✓ 一次索引查找即可（覆盖索引）</text>
  </g>
  
  <!-- 回表查询箭头 -->
  <path d="M700,820 Q750,780 500,590" stroke="#ff3366" stroke-width="2" fill="none" stroke-dasharray="5,5"/>
  <polygon points="500,590 505,580 495,580" fill="#ff3366"/>
  <text x="600" y="690" text-anchor="middle" font-size="12" fill="#ff3366" font-weight="bold">回表查询</text>
  
  <!-- 箭头从二级索引指向主键索引 -->
  <path d="M650,400 Q600,350 440,450" stroke="#ff3366" stroke-width="2" fill="none" stroke-dasharray="5,5"/>
  <polygon points="440,450 445,440 435,440" fill="#ff3366"/>
  
  <!-- 图例 -->
  <rect x="80" y="900" width="1440" height="60" rx="6" ry="6" fill="#f8f8f8" stroke="#ccc" stroke-width="1"/>
  <text x="100" y="920" font-size="14" font-weight="bold" fill="#333">图例：</text>
  
  <rect x="180" y="910" width="18" height="18" fill="#eef2ff" stroke="#4a6bff" stroke-width="1"/>
  <text x="205" y="925" font-size="13" dominant-baseline="middle">主键索引</text>
  
  <rect x="300" y="910" width="18" height="18" fill="#fff5f0" stroke="#ff8a3d" stroke-width="1"/>
  <text x="325" y="925" font-size="13" dominant-baseline="middle">二级索引</text>
  
  <rect x="420" y="910" width="18" height="18" fill="#f8fff8" stroke="#34c759" stroke-width="1"/>
  <text x="445" y="925" font-size="13" dominant-baseline="middle">数据页</text>
  
  <path d="M540,919 L560,919" stroke="#ff6b35" stroke-width="2" fill="none"/>
  <polygon points="560,919 555,914 555,924" fill="#ff6b35"/>
  <text x="590" y="925" font-size="13" dominant-baseline="middle">双向链表指针</text>
  
  <path d="M700,919 L720,919" stroke="#ff3366" stroke-width="2" fill="none" stroke-dasharray="5,5"/>
  <text x="750" y="925" font-size="13" dominant-baseline="middle">回表查询</text>
  
  <path d="M840,919 L860,919" stroke="#4a6bff" stroke-width="2" fill="none"/>
  <polygon points="860,919 855,914 855,924" fill="#4a6bff"/>
  <text x="900" y="925" font-size="13" dominant-baseline="middle">主键引用</text>
  
  <rect x="1000" y="910" width="18" height="18" fill="#ffffff" stroke="#4a6bff" stroke-width="1"/>
  <text x="1025" y="925" font-size="13" dominant-baseline="middle">行数据</text>
  
  <rect x="1150" y="910" width="18" height="18" fill="#e6ffe6" stroke="#34c759" stroke-width="1"/>
  <text x="1175" y="925" font-size="13" dominant-baseline="middle">覆盖索引</text>
  
  <!-- 底部说明 -->
  <text x="800" y="980" text-anchor="middle" font-size="12" fill="#666">
    MySQL InnoDB存储引擎 | 主键索引是聚集索引，叶子节点存储完整数据 | 二级索引叶子节点存储索引列+主键值
  </text>
</svg>